/**********************************************************************************************************************************
 *
 * @file		funciones.c
 * @brief		Descripcion del modulo
 * @date		02-05-2020
 * @author		Luis Mora
 *
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/
#include "funciones.h"

/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/**
    \fn     recibir
    \brief  recibe informacion del servidor
    \author Luis Mora
    \date   06-05-2020
    \return 0 si hay exito, 1 si hay un error;
*/
int recibir( int sock ){
    int buf;
    printf("RECIBIDO:");
    for ( int i=0; i<VALNUM; i++ ){
        leefd( sock,&buf,sizeof(int) );
        printf("%d",buf);
        if ( i!=VALNUM-1 )
            printf(",");
        else
            printf(".\n");
    }
    return 0;
}

 /***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/

/**
    \fn     conectar
    \brief  Crea el socket que sera usado por el cliente
            y conecta al servidor
    \author Luis Mora
    \date   06-05-2020
    \return 0 si hay exito, 1 si hay un error;
*/
int conectar( char* ip ){
    int sockfd = creasockettcp();
    struct sockaddr_in seradr;
    direcciontcp( &seradr,PUERTO,ip );
    conectartcp( sockfd,&seradr,sizeof( struct sockaddr ) );
    printf("CONEXION ESTABLECIDA:\n");
    recibir( sockfd );
    cerrartcp( sockfd );
    return 0;
}
